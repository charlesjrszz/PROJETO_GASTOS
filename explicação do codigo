# ğŸ“˜ DocumentaÃ§Ã£o TÃ©cnica - Fin Organizer

Este documento serve como guia de referÃªncia para a arquitetura, estrutura de arquivos e fluxo de dados do projeto **Fin Organizer**.

---

## ğŸ— VisÃ£o Geral da Arquitetura

O projeto utiliza a arquitetura padrÃ£o do **Electron**, separando a lÃ³gica de sistema da interface visual:

1.  **Main Process (Node.js)**: Acesso ao sistema operacional, sistema de arquivos e banco de dados.
2.  **Renderer Process (Web)**: Interface grÃ¡fica interativa.
3.  **Preload (Bridge)**: Camada de seguranÃ§a que conecta os dois processos.

---

## ğŸ“‚ Estrutura de Pastas e Arquivos

```text
PROJETO_GASTOS/
â”œâ”€â”€ main.js                # Ponto de entrada (Backend local)
â”œâ”€â”€ preload.js             # Ponte de seguranÃ§a (ContextBridge)
â”œâ”€â”€ store.js               # Banco de dados e Regras de NegÃ³cio
â”œâ”€â”€ package.json           # DependÃªncias e Scripts
â”œâ”€â”€ parsers/               # MÃ³dulos de leitura de arquivos
â”‚   â”œâ”€â”€ ofxParser.js       # Leitor de extratos bancÃ¡rios (.ofx)
â”‚   â””â”€â”€ xlsxParser.js      # Leitor de planilhas (.xlsx, .csv)
â””â”€â”€ renderer/              # Frontend (Interface do UsuÃ¡rio)
    â”œâ”€â”€ index.html         # Estrutura HTML


EXPLICAÃ‡ÃƒO SOBRE CADA PASTA 

1. Processo Principal (Backend)
main.js
ResponsÃ¡vel por iniciar a aplicaÃ§Ã£o e orquestrar as operaÃ§Ãµes nativas.

Ciclo de Vida: Cria a janela principal (createWindow) carregando o index.html.

ComunicaÃ§Ã£o (IPC): Escuta requisiÃ§Ãµes do frontend atravÃ©s do ipcMain.

select-files: Abre o seletor de arquivos do SO, invoca os parsers e salva os dados.

export-csv: Gera o arquivo de saÃ­da CSV.

Delegator: Repassa chamadas de banco de dados (get-transactions, add-category) diretamente para o store.js.

store.js
Atua como o "Banco de Dados" e "Controller" da aplicaÃ§Ã£o.

PersistÃªncia: Utiliza a biblioteca electron-store para gravar dados em um arquivo JSON local (finance-data).

CRUD: Gerencia a leitura e escrita de transaÃ§Ãµes (getAllTransactions, addTransaction) e categorias.

CategorizaÃ§Ã£o AutomÃ¡tica: A funÃ§Ã£o applyCategoryRules(tx) verifica se a descriÃ§Ã£o de uma nova transaÃ§Ã£o corresponde a alguma regra criada pelo usuÃ¡rio e atribui a categoria automaticamente antes de salvar.

2. Processamento de Arquivos (Parsers)
Scripts auxiliares para transformar arquivos externos em objetos JavaScript padronizados.

parsers/ofxParser.js
Focado em arquivos bancÃ¡rios .ofx ou .qfx.

Usa ExpressÃµes Regulares (Regex) para extrair blocos de transaÃ§Ãµes (<STMTTRN>), datas e valores.

parsers/xlsxParser.js
LÃª planilhas .xlsx, .ods e .csv usando a biblioteca xlsx.

HeurÃ­stica: Tenta identificar automaticamente colunas de Data, Valor e DescriÃ§Ã£o procurando por sinÃ´nimos (ex: "HistÃ³rico", "Amount", "Valor (R$)").

Realiza a limpeza de formataÃ§Ã£o monetÃ¡ria (remove sÃ­mbolos de moeda e corrige pontuaÃ§Ã£o).

3. Camada de SeguranÃ§a
preload.js
Utiliza contextBridge para expor uma API segura (window.electronAPI) para o navegador.

Define exatamente quais funÃ§Ãµes o frontend pode executar no backend (ex: selectFiles, addRule), impedindo execuÃ§Ã£o de cÃ³digo arbitrÃ¡rio.

4. Interface (Frontend)
renderer/index.html
Define o layout visual: cabeÃ§alho com aÃ§Ãµes, Ã¡rea de resumo, tabela de transaÃ§Ãµes e painel de categorias.

renderer/renderer.js
Gerencia a interatividade da pÃ¡gina.

RenderizaÃ§Ã£o: ConstrÃ³i a tabela HTML e listas de categorias dinamicamente com base nos dados recebidos.

Filtros Locais: Implementa a lÃ³gica de filtrar transaÃ§Ãµes por data ou nome na memÃ³ria, sem nova consulta ao disco.

Eventos: Captura cliques (botÃµes de importar, excluir, adicionar regra) e chama as funÃ§Ãµes da electronAPI.

ğŸ”„ Exemplo de Fluxo: ImportaÃ§Ã£o
UsuÃ¡rio clica em "Importar arquivos" na interface (renderer.js).

Frontend chama window.electronAPI.selectFiles() (preload.js).

Backend (main.js) abre a janela de seleÃ§Ã£o de arquivos.

Backend lÃª o arquivo e escolhe o parser adequado (ofxParser ou xlsxParser).

Dados extraÃ­dos sÃ£o enviados para store.addTransaction() (store.js).

O store.js aplica as regras de categoria (applyCategoryRules) e salva no JSON.

Frontend recebe o resumo e atualiza a tabela na tela.
    â””â”€â”€ renderer.js        # LÃ³gica da tela (DOM e Eventos)
